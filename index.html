<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CareerProfile - AI Professional Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'JetBrains Mono', monospace;
            background: #0a0a0a;
            color: #00ff41;
            overflow-x: hidden;
        }
        
        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            background: radial-gradient(ellipse at center, #0a0a0a 0%, #000000 100%);
        }
        
        .cyber-glow {
            box-shadow: 0 0 20px #00ff41, 0 0 40px #00ff41, 0 0 60px #00ff41;
        }
        
        .cyber-border {
            border: 1px solid #00ff41;
            box-shadow: 0 0 10px #00ff41, inset 0 0 10px #00ff41;
        }
        
        .hologram-effect {
            background: linear-gradient(135deg, rgba(0, 255, 65, 0.1) 0%, rgba(0, 255, 65, 0.05) 100%);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 255, 65, 0.3);
        }
        
        .neon-text {
            text-shadow: 0 0 10px #00ff41, 0 0 20px #00ff41, 0 0 30px #00ff41;
        }
        
        .cyber-button {
            background: linear-gradient(45deg, #00ff41, #008631);
            border: none;
            color: #000;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .cyber-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 65, 0.4);
        }
        
        .matrix-rain {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.1;
        }
        
        .pulse-glow {
            animation: pulse-glow 2s infinite;
        }
        
        @keyframes pulse-glow {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .floating {
            animation: floating 3s ease-in-out infinite;
        }
        
        @keyframes floating {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .typewriter {
            overflow: hidden;
            border-right: 2px solid #00ff41;
            white-space: nowrap;
            animation: typing 3.5s steps(40, end), blink-caret 0.75s step-end infinite;
        }
        
        @keyframes typing {
            from { width: 0 }
            to { width: 100% }
        }
        
        @keyframes blink-caret {
            from, to { border-color: transparent }
            50% { border-color: #00ff41 }
        }
        
        input, textarea {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid #00ff41;
            color: #00ff41;
            transition: all 0.3s ease;
        }
        
        input:focus, textarea:focus {
            outline: none;
            box-shadow: 0 0 10px #00ff41;
            background: rgba(0, 255, 65, 0.1);
        }
        
        .cyber-loader {
            border: 3px solid #00ff41;
            border-top: 3px solid transparent;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body class="bg-black text-green-400">
    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="hidden fixed inset-0 bg-black/80 flex items-center justify-center z-50">
        <div class="text-center">
            <div class="cyber-loader mx-auto mb-4"></div>
            <p class="text-green-400 neon-text">PROCESSING...</p>
        </div>
    </div>

    <!-- Matrix Background -->
    <div class="matrix-bg"></div>
    <canvas class="matrix-rain" id="matrixCanvas"></canvas>

    <!-- Navigation -->
    <nav class="hologram-effect border-b border-green-400/30 sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
                    <div class="cyber-glow bg-gradient-to-r from-green-400 to-green-600 text-black p-3 rounded-lg floating">
                        <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold neon-text">CareerProfile</h1>
                        <p class="text-xs text-green-300 typewriter">AI-Powered Professional Platform</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4" id="authButtons">
                    <button onclick="showLogin()" class="text-green-400 hover:text-green-200 font-semibold pulse-glow">[ LOGIN ]</button>
                    <button onclick="showSignup()" class="cyber-button px-6 py-2 rounded-lg font-semibold">[ SIGN UP ]</button>
                </div>
                <div class="hidden items-center space-x-4" id="userMenu">
                    <span class="text-green-300" id="userGreeting">Welcome, User!</span>
                    <button onclick="logout()" class="text-green-400 hover:text-green-200 font-semibold">[ LOGOUT ]</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Authentication -->
    <div id="authSection" class="max-w-md mx-auto mt-12 hologram-effect rounded-lg p-8 cyber-border">
        <div id="loginForm">
            <h2 class="text-2xl font-bold neon-text mb-6 text-center">[ ACCESS GRANTED ]</h2>
            <div class="space-y-4">
                <input type="email" id="loginEmail" placeholder=">> EMAIL" class="w-full p-3 rounded-lg">
                <input type="password" id="loginPassword" placeholder=">> PASSWORD" class="w-full p-3 rounded-lg">
                <button onclick="login()" class="w-full cyber-button py-3 rounded-lg font-semibold">[ AUTHENTICATE ]</button>
            </div>
            <div class="text-center mt-4">
                <button onclick="showSignup()" class="text-green-400 hover:text-green-200">[ CREATE PROFILE ]</button>
            </div>
        </div>

        <div id="signupForm" class="hidden">
            <h2 class="text-2xl font-bold neon-text mb-6 text-center">[ PROFILE INIT ]</h2>
            <div class="space-y-4">
                <input type="text" id="signupName" placeholder=">> FULL NAME" class="w-full p-3 rounded-lg">
                <input type="email" id="signupEmail" placeholder=">> EMAIL" class="w-full p-3 rounded-lg">
                <input type="password" id="signupPassword" placeholder=">> PASSWORD" class="w-full p-3 rounded-lg">
                <button onclick="signup()" class="w-full cyber-button py-3 rounded-lg font-semibold">[ INITIALIZE SYSTEM ]</button>
            </div>
            <div class="text-center mt-4">
                <button onclick="showLogin()" class="text-green-400 hover:text-green-200">[ BACK TO LOGIN ]</button>
            </div>
        </div>
    </div>

    <!-- Main Application -->
    <div id="appSection" class="hidden max-w-7xl mx-auto py-8 px-4">
        <!-- Dashboard Tabs -->
        <div class="hologram-effect rounded-lg p-6 mb-8 cyber-border">
            <div class="flex space-x-8 border-b border-green-400/30">
                <button class="tab-button py-3 px-4 border-b-2 border-green-400 text-green-400 font-semibold neon-text" onclick="showTab('profile')">[ PROFILE BUILDER ]</button>
                <button class="tab-button py-3 px-4 border-b-2 border-transparent text-green-300 hover:text-green-100" onclick="showTab('resume')">[ RESUME GENERATOR ]</button>
                <button class="tab-button py-3 px-4 border-b-2 border-transparent text-green-300 hover:text-green-100" onclick="showTab('jobs')">[ JOB MATRIX ]</button>
            </div>
        </div>

        <!-- Profile Builder Tab -->
        <div id="profileTab" class="tab-content">
            <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
                <!-- Navigation -->
                <div class="lg:col-span-1 space-y-4">
                    <div class="hologram-effect rounded-lg p-6 cyber-border">
                        <h3 class="font-semibold neon-text mb-4">[ PROFILE MODULES ]</h3>
                        <div class="space-y-2">
                            <button onclick="showProfileSection('personal')" class="w-full text-left p-3 rounded-lg hover:bg-green-400/10 text-green-400 font-semibold bg-green-400/20 cyber-border">[ PERSONAL DATA ]</button>
                            <button onclick="showProfileSection('summary')" class="w-full text-left p-3 rounded-lg hover:bg-green-400/10 text-green-300">[ PROFILE SUMMARY ]</button>
                            <button onclick="showProfileSection('experience')" class="w-full text-left p-3 rounded-lg hover:bg-green-400/10 text-green-300">[ EXPERIENCE MATRIX ]</button>
                            <button onclick="showProfileSection('education')" class="w-full text-left p-3 rounded-lg hover:bg-green-400/10 text-green-300">[ EDUCATION NODES ]</button>
                            <button onclick="showProfileSection('skills')" class="w-full text-left p-3 rounded-lg hover:bg-green-400/10 text-green-300">[ SKILL SET ]</button>
                        </div>
                    </div>

                    <div class="hologram-effect rounded-lg p-6 cyber-border">
                        <h3 class="font-semibold neon-text mb-4">[ SYSTEM PROGRESS ]</h3>
                        <div class="space-y-3">
                            <div>
                                <div class="flex justify-between text-sm mb-1">
                                    <span>PROFILE COMPLETION</span>
                                    <span id="overallProgress">0%</span>
                                </div>
                                <div class="w-full bg-green-400/20 rounded-full h-2">
                                    <div id="progressBar" class="bg-green-400 h-2 rounded-full transition-all neon-text" style="width: 0%"></div>
                                </div>
                            </div>
                            <button onclick="saveProfile()" class="w-full cyber-button py-2 rounded-lg font-semibold">[ SAVE PROFILE ]</button>
                        </div>
                    </div>
                </div>

                <!-- Profile Content -->
                <div class="lg:col-span-3">
                    <!-- Personal Information -->
                    <div id="personalSection" class="profile-section hologram-effect rounded-lg p-6 cyber-border">
                        <h3 class="text-xl font-semibold neon-text mb-6">[ PERSONAL DATA MODULE ]</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="text" id="fullName" placeholder=">> FULL NAME" class="p-3 rounded-lg">
                            <input type="text" id="professionalTitle" placeholder=">> PROFESSIONAL TITLE" class="p-3 rounded-lg">
                            <input type="email" id="email" placeholder=">> EMAIL" class="p-3 rounded-lg">
                            <input type="tel" id="phone" placeholder=">> PHONE" class="p-3 rounded-lg">
                            <input type="text" id="location" placeholder=">> LOCATION" class="p-3 rounded-lg">
                            <input type="url" id="linkedin" placeholder=">> LINKEDIN URL" class="p-3 rounded-lg">
                        </div>
                    </div>

                    <!-- Professional Summary -->
                    <div id="summarySection" class="profile-section hidden hologram-effect rounded-lg p-6 cyber-border">
                        <h3 class="text-xl font-semibold neon-text mb-6">[ PROFILE SUMMARY ]</h3>
                        <textarea id="summary" placeholder=">> ENTER PROFESSIONAL SUMMARY..." class="w-full p-4 rounded-lg h-32"></textarea>
                    </div>

                    <!-- Work Experience -->
                    <div id="experienceSection" class="profile-section hidden hologram-effect rounded-lg p-6 cyber-border">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold neon-text">[ EXPERIENCE MATRIX ]</h3>
                            <button onclick="addExperience()" class="cyber-button px-4 py-2 rounded-lg font-semibold">[ + ADD NODE ]</button>
                        </div>
                        <div id="experienceContainer"></div>
                    </div>

                    <!-- Education -->
                    <div id="educationSection" class="profile-section hidden hologram-effect rounded-lg p-6 cyber-border">
                        <div class="flex justify-between items-center mb-6">
                            <h3 class="text-xl font-semibold neon-text">[ EDUCATION NODES ]</h3>
                            <button onclick="addEducation()" class="cyber-button px-4 py-2 rounded-lg font-semibold">[ + ADD NODE ]</button>
                        </div>
                        <div id="educationContainer"></div>
                    </div>

                    <!-- Skills -->
                    <div id="skillsSection" class="profile-section hidden hologram-effect rounded-lg p-6 cyber-border">
                        <h3 class="text-xl font-semibold neon-text mb-6">[ SKILL SET MATRIX ]</h3>
                        <textarea id="skills" placeholder=">> ENTER SKILLS (ONE PER LINE)..." class="w-full p-4 rounded-lg h-32"></textarea>
                    </div>
                </div>
            </div>
        </div>

        <!-- Resume Generator Tab -->
        <div id="resumeTab" class="tab-content hidden">
            <div class="hologram-effect rounded-lg p-8 cyber-border">
                <h2 class="text-2xl font-bold neon-text mb-6">[ RESUME GENERATOR ]</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="font-semibold neon-text mb-4">[ RESUME PREVIEW ]</h3>
                        <div class="bg-black/50 border border-green-400 rounded-lg p-6 h-96 overflow-y-auto cyber-border">
                            <div id="resumePreview">
                                <p class="text-green-600">>> RESUME DATA WILL APPEAR HERE...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold neon-text mb-4">[ EXPORT MODULES ]</h3>
                        <div class="space-y-4">
                            <button onclick="generateResume()" class="w-full cyber-button py-3 rounded-lg font-semibold">[ GENERATE RESUME ]</button>
                            <button onclick="downloadPDF()" class="w-full cyber-button py-3 rounded-lg font-semibold">[ EXPORT PDF ]</button>
                            <button onclick="downloadWord()" class="w-full cyber-button py-3 rounded-lg font-semibold">[ EXPORT DOC ]</button>
                        </div>
                        
                        <div class="mt-6">
                            <h3 class="font-semibold neon-text mb-4">[ AI ENHANCEMENT ]</h3>
                            <button onclick="enhanceWithAI()" class="w-full cyber-button py-3 rounded-lg font-semibold">[ AI OPTIMIZE ]</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Job Matcher Tab -->
        <div id="jobsTab" class="tab-content hidden">
            <div class="hologram-effect rounded-lg p-8 cyber-border">
                <h2 class="text-2xl font-bold neon-text mb-6">[ JOB MATRIX ANALYZER ]</h2>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <h3 class="font-semibold neon-text mb-4">[ INPUT JOB DATA ]</h3>
                        <textarea id="jobDescription" placeholder=">> PASTE JOB DESCRIPTION..." class="w-full p-4 rounded-lg h-64 cyber-border"></textarea>
                        <button onclick="analyzeJob()" class="w-full cyber-button py-3 rounded-lg font-semibold mt-4">[ ANALYZE COMPATIBILITY ]</button>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold neon-text mb-4">[ ANALYSIS RESULTS ]</h3>
                        <div id="matchResults" class="bg-black/50 border border-green-400 rounded-lg p-6 cyber-border">
                            <p class="text-green-600">>> ANALYSIS DATA WILL APPEAR HERE...</p>
                        </div>
                        
                        <div class="mt-6 grid grid-cols-2 gap-4 hidden" id="matchScores">
                            <div class="text-center bg-green-400/20 rounded-lg p-4 cyber-border">
                                <div class="text-2xl font-bold text-green-400 neon-text" id="skillsMatch">0%</div>
                                <div class="text-sm text-green-300">SKILLS MATCH</div>
                            </div>
                            <div class="text-center bg-green-400/20 rounded-lg p-4 cyber-border">
                                <div class="text-2xl font-bold text-green-400 neon-text" id="experienceMatch">0%</div>
                                <div class="text-sm text-green-300">EXPERIENCE MATCH</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ==================== MATRIX RAIN BACKGROUND ====================
        class MatrixRain {
            constructor(canvas) {
                this.canvas = canvas;
                this.ctx = canvas.getContext('2d');
                this.chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$#@%&*";
                this.drops = [];
                this.init();
            }

            init() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
                
                const columns = this.canvas.width / 20;
                this.drops = Array(Math.floor(columns)).fill(1);
                
                window.addEventListener('resize', () => {
                    this.canvas.width = window.innerWidth;
                    this.canvas.height = window.innerHeight;
                    const newColumns = this.canvas.width / 20;
                    this.drops = Array(Math.floor(newColumns)).fill(1);
                });
            }

            draw() {
                this.ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
                this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);
                
                this.ctx.fillStyle = '#00ff41';
                this.ctx.font = '15px JetBrains Mono';
                
                this.drops.forEach((y, index) => {
                    const text = this.chars[Math.floor(Math.random() * this.chars.length)];
                    const x = index * 20;
                    
                    this.ctx.fillText(text, x, y);
                    
                    if (y > this.canvas.height && Math.random() > 0.975) {
                        this.drops[index] = 0;
                    }
                    
                    this.drops[index]++;
                });
            }

            start() {
                setInterval(() => this.draw(), 33);
            }
        }

        // ==================== FIREBASE CONFIG ====================
        const firebaseConfig = {
            apiKey: "AIzaSyA_Si4j_KI1ufVg0_tthDFZjkrnYs-XNtE",
            authDomain: "resume-ai-platform.firebaseapp.com",
            projectId: "resume-ai-platform",
            storageBucket: "resume-ai-platform.firebasestorage.app",
            messagingSenderId: "246570862355",
            appId: "1:246570862355:web:4f4e2e3e3fdf366d95bce6"
        };

        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let currentUser = null;
        let userProfile = {};

        // ==================== LOADING FUNCTIONS ====================
        function showLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.remove('hidden');
            }
        }

        function hideLoading() {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                overlay.classList.add('hidden');
            }
        }

        // ==================== AUTHENTICATION ====================
        function showLogin() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
        }

        function showSignup() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
        }

        function signup() {
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;

            if (!name || !email || !password) {
                showNotification('ERROR: Please fill all fields', true);
                return;
            }

            showLoading();
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    currentUser = userCredential.user;
                    userProfile = {
                        personal: { fullName: name, email: email },
                        summary: '',
                        experience: [],
                        education: [],
                        skills: ''
                    };
                    return db.collection('profiles').doc(currentUser.uid).set(userProfile);
                })
                .then(() => {
                    hideLoading();
                    showNotification('SYSTEM: Profile initialized successfully');
                    showApp();
                    loadUserProfile();
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('ERROR: ' + error.message, true);
                });
        }

        function login() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;

            if (!email || !password) {
                showNotification('ERROR: Please fill all fields', true);
                return;
            }

            showLoading();
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    currentUser = userCredential.user;
                    hideLoading();
                    showNotification('SYSTEM: Access granted');
                    showApp();
                    loadUserProfile();
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('ERROR: ' + error.message, true);
                });
        }

        function logout() {
            showLoading();
            auth.signOut().then(() => {
                currentUser = null;
                userProfile = {};
                hideLoading();
                showNotification('SYSTEM: Logged out');
                showAuth();
            }).catch((error) => {
                hideLoading();
                showNotification('ERROR: ' + error.message, true);
            });
        }

        // ==================== PROFILE MANAGEMENT ====================
        function loadUserProfile() {
            showLoading();
            db.collection('profiles').doc(currentUser.uid).get()
                .then((doc) => {
                    if (doc.exists) {
                        userProfile = doc.data();
                        populateForm();
                        updateProgress();
                    }
                    hideLoading();
                })
                .catch((error) => {
                    hideLoading();
                    console.error('Error loading profile:', error);
                });
        }

        function populateForm() {
            if (userProfile.personal) {
                document.getElementById('fullName').value = userProfile.personal.fullName || '';
                document.getElementById('professionalTitle').value = userProfile.personal.professionalTitle || '';
                document.getElementById('email').value = userProfile.personal.email || '';
                document.getElementById('phone').value = userProfile.personal.phone || '';
                document.getElementById('location').value = userProfile.personal.location || '';
                document.getElementById('linkedin').value = userProfile.personal.linkedin || '';
            }
            document.getElementById('summary').value = userProfile.summary || '';
            document.getElementById('skills').value = userProfile.skills || '';
            
            // Load experiences
            const expContainer = document.getElementById('experienceContainer');
            expContainer.innerHTML = '';
            if (userProfile.experience && userProfile.experience.length > 0) {
                userProfile.experience.forEach(exp => addExperience(exp));
            } else {
                addExperience();
            }

            // Load education
            const eduContainer = document.getElementById('educationContainer');
            eduContainer.innerHTML = '';
            if (userProfile.education && userProfile.education.length > 0) {
                userProfile.education.forEach(edu => addEducation(edu));
            } else {
                addEducation();
            }
        }

        function saveProfile() {
            showLoading();
            
            // Collect experience data
            const experiences = [];
            document.querySelectorAll('#experienceContainer > div').forEach(expElement => {
                const title = expElement.querySelector('.exp-title')?.value || '';
                const company = expElement.querySelector('.exp-company')?.value || '';
                const start = expElement.querySelector('.exp-start')?.value || '';
                const end = expElement.querySelector('.exp-end')?.value || '';
                const description = expElement.querySelector('.exp-desc')?.value || '';
                
                if (title || company) {
                    experiences.push({ title, company, start, end, description });
                }
            });

            // Collect education data
            const education = [];
            document.querySelectorAll('#educationContainer > div').forEach(eduElement => {
                const degree = eduElement.querySelector('.edu-degree')?.value || '';
                const school = eduElement.querySelector('.edu-school')?.value || '';
                const year = eduElement.querySelector('.edu-year')?.value || '';
                const gpa = eduElement.querySelector('.edu-gpa')?.value || '';
                
                if (degree || school) {
                    education.push({ degree, school, year, gpa });
                }
            });

            userProfile.personal = {
                fullName: document.getElementById('fullName').value,
                professionalTitle: document.getElementById('professionalTitle').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                location: document.getElementById('location').value,
                linkedin: document.getElementById('linkedin').value
            };
            userProfile.summary = document.getElementById('summary').value;
            userProfile.skills = document.getElementById('skills').value;
            userProfile.experience = experiences;
            userProfile.education = education;

            db.collection('profiles').doc(currentUser.uid).set(userProfile)
                .then(() => {
                    hideLoading();
                    showNotification('SYSTEM: Profile saved successfully');
                    updateProgress();
                })
                .catch((error) => {
                    hideLoading();
                    showNotification('ERROR: ' + error.message, true);
                });
        }

        // ==================== EXPERIENCE & EDUCATION ====================
        function addExperience(expData = {}) {
            const container = document.getElementById('experienceContainer');
            const expId = 'exp_' + Date.now();
            const expHtml = `
                <div class="border border-green-400 rounded-lg p-4 mb-4 cyber-border" data-id="${expId}">
                    <div class="grid grid-cols-2 gap-4 mb-4">
                        <input type="text" class="p-2 border border-green-400 rounded exp-title bg-black/50" placeholder=">> JOB TITLE" value="${expData.title || ''}">
                        <input type="text" class="p-2 border border-green-400 rounded exp-company bg-black/50" placeholder=">> COMPANY" value="${expData.company || ''}">
                        <input type="text" class="p-2 border border-green-400 rounded exp-start bg-black/50" placeholder=">> START DATE" value="${expData.start || ''}">
                        <input type="text" class="p-2 border border-green-400 rounded exp-end bg-black/50" placeholder=">> END DATE" value="${expData.end || ''}">
                    </div>
                    <textarea class="w-full p-2 border border-green-400 rounded exp-desc bg-black/50" placeholder=">> DESCRIPTION">${expData.description || ''}</textarea>
                    <button onclick="removeExperience('${expId}')" class="text-red-400 hover:text-red-200 mt-2 font-semibold">[ REMOVE NODE ]</button>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', expHtml);
        }

        function addEducation(eduData = {}) {
            const container = document.getElementById('educationContainer');
            const eduId = 'edu_' + Date.now();
            const eduHtml = `
                <div class="border border-green-400 rounded-lg p-4 mb-4 cyber-border" data-id="${eduId}">
                    <div class="grid grid-cols-2 gap-4">
                        <input type="text" class="p-2 border border-green-400 rounded edu-degree bg-black/50" placeholder=">> DEGREE" value="${eduData.degree || ''}">
                        <input type="text" class="p-2 border border-green-400 rounded edu-school bg-black/50" placeholder=">> INSTITUTION" value="${eduData.school || ''}">
                        <input type="text" class="p-2 border border-green-400 rounded edu-year bg-black/50" placeholder=">> YEAR" value="${eduData.year || ''}">
                        <input type="text" class="p-2 border border-green-400 rounded edu-gpa bg-black/50" placeholder=">> GPA" value="${eduData.gpa || ''}">
                    </div>
                    <button onclick="removeEducation('${eduId}')" class="text-red-400 hover:text-red-200 mt-2 font-semibold">[ REMOVE NODE ]</button>
                </div>
            `;
            container.insertAdjacentHTML('beforeend', eduHtml);
        }

        function removeExperience(id) {
            const element = document.querySelector(`[data-id="${id}"]`);
            if (element) {
                element.remove();
            }
        }

        function removeEducation(id) {
            const element = document.querySelector(`[data-id="${id}"]`);
            if (element) {
                element.remove();
            }
        }

        // ==================== RESUME GENERATOR ====================
        function generateResume() {
            showLoading();
            setTimeout(() => {
                const resumeContent = `
                    <div class="text-green-400">
                        <h2 class="text-2xl font-bold mb-4 neon-text">${userProfile.personal?.fullName || 'YOUR NAME'}</h2>
                        <p class="text-green-300 mb-4">${userProfile.personal?.professionalTitle || 'PROFESSIONAL'}</p>
                        
                        <div class="mb-6">
                            <h3 class="font-semibold mb-2 neon-text">CONTACT MATRIX</h3>
                            <p>> Email: ${userProfile.personal?.email || 'N/A'}</p>
                            <p>> Phone: ${userProfile.personal?.phone || 'N/A'}</p>
                            <p>> Location: ${userProfile.personal?.location || 'N/A'}</p>
                        </div>

                        <div class="mb-6">
                            <h3 class="font-semibold mb-2 neon-text">PROFILE SUMMARY</h3>
                            <p>${userProfile.summary || 'Your professional summary'}</p>
                        </div>

                        <div class="mb-6">
                            <h3 class="font-semibold mb-2 neon-text">SKILL MATRIX</h3>
                            <p>${userProfile.skills || 'Your skills'}</p>
                        </div>
                    </div>
                `;
                document.getElementById('resumePreview').innerHTML = resumeContent;
                hideLoading();
                showNotification('SYSTEM: Resume generated successfully');
            }, 1000);
        }

        function downloadPDF() {
            showNotification('SYSTEM: PDF export initialized');
        }

        function downloadWord() {
            showNotification('SYSTEM: Word document export initialized');
        }

        function enhanceWithAI() {
            showNotification('SYSTEM: AI enhancement protocol activated');
        }

        // ==================== JOB MATCHER ====================
        function analyzeJob() {
            const jobDesc = document.getElementById('jobDescription').value;
            if (!jobDesc) {
                showNotification('ERROR: Please input job description', true);
                return;
            }

            showLoading();
            setTimeout(() => {
                document.getElementById('skillsMatch').textContent = '85%';
                document.getElementById('experienceMatch').textContent = '78%';
                document.getElementById('matchScores').classList.remove('hidden');
                
                document.getElementById('matchResults').innerHTML = `
                    <h4 class="font-semibold mb-2 neon-text">ANALYSIS COMPLETE</h4>
                    <p class="text-sm mb-4 text-green-300">Profile compatibility: HIGH</p>
                    <ul class="text-sm space-y-1 text-green-300">
                        <li>‚úÖ Strong skills alignment detected</li>
                        <li>‚úÖ Relevant experience matrix confirmed</li>
                        <li>üìù Recommend emphasizing leadership protocols</li>
                        <li>üîß Technical skills match: 92%</li>
                    </ul>
                `;
                hideLoading();
                showNotification('SYSTEM: Job analysis complete');
            }, 2000);
        }

        // ==================== UI MANAGEMENT ====================
        function showAuth() {
            document.getElementById('authSection').classList.remove('hidden');
            document.getElementById('appSection').classList.add('hidden');
            document.getElementById('authButtons').classList.remove('hidden');
            document.getElementById('userMenu').classList.add('hidden');
        }

        function showApp() {
            document.getElementById('authSection').classList.add('hidden');
            document.getElementById('appSection').classList.remove('hidden');
            document.getElementById('authButtons').classList.add('hidden');
            document.getElementById('userMenu').classList.remove('hidden');
            document.getElementById('userGreeting').textContent = `USER: ${userProfile.personal?.fullName || 'Operator'}`;
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.add('hidden'));
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('border-green-400', 'text-green-400', 'neon-text');
                btn.classList.add('border-transparent', 'text-green-300');
            });
            
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            event.target.classList.add('border-green-400', 'text-green-400', 'neon-text');
        }

        function showProfileSection(sectionName) {
            document.querySelectorAll('.profile-section').forEach(section => section.classList.add('hidden'));
            document.getElementById(sectionName + 'Section').classList.remove('hidden');
            
            document.querySelectorAll('#profileTab button').forEach(btn => {
                btn.classList.remove('bg-green-400/20', 'text-green-400', 'cyber-border');
                btn.classList.add('text-green-300', 'hover:bg-green-400/10');
            });
            event.target.classList.add('bg-green-400/20', 'text-green-400', 'cyber-border');
        }

        function updateProgress() {
            let progress = 0;
            if (userProfile.personal?.fullName) progress += 25;
            if (userProfile.summary) progress += 25;
            if (userProfile.experience?.length > 0) progress += 25;
            if (userProfile.skills) progress += 25;
            
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('overallProgress').textContent = progress + '%';
        }

        // ==================== UTILITY FUNCTIONS ====================
        function showNotification(message, isError = false) {
            // Remove existing notifications
            document.querySelectorAll('.notification').forEach(n => n.remove());
            
            const notification = document.createElement('div');
            notification.className = `notification fixed top-4 right-4 p-4 rounded-lg border ${
                isError ? 'bg-red-500/20 border-red-400 text-red-400' : 'bg-green-500/20 border-green-400 text-green-400'
            } z-50 cyber-border neon-text`;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 3000);
        }

        // ==================== INITIALIZATION ====================
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                showApp();
                loadUserProfile();
            } else {
                showAuth();
            }
        });

        // Initialize first sections and matrix rain
        document.addEventListener('DOMContentLoaded', function() {
            // Start matrix rain
            const canvas = document.getElementById('matrixCanvas');
            if (canvas) {
                const matrix = new MatrixRain(canvas);
                matrix.start();
            }
            
            // Initialize first section
            showProfileSection('personal');
            
            // Ensure loading overlay is hidden on startup
            hideLoading();
        });
    </script>
</body>
</html>
